---
title: "Documentation"
author: "Pawel Pienczuk"
date: "2025-05-14"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

This document provides instructions on how to use the custom R functions included in this package. The package contains functions for analyzing stock data from the Warsaw Stock Exchange (WSE) and for analyzing parts distribution in a manufacturing context.



## Functions Included

This package currently includes the following functions:

* `what_to_buy()`: Downloads and plots WSE stock data.
* `parts_distribution()`: Calculates and visualizes part variants distribution.
* `analyze_parts_distribution()`: Analyzes results from `parts_distribution()`.

## Getting Started

To use these functions:

1.  Ensure you have R and RStudio installed.
2.  Install the required packages: `ggplot2`, `tidyr`, `dplyr`, `lubridate`, `broom`, `scales`, `testthat`. You can install them using `install.packages()`.
3.  Source the function definitions into your R session. If these functions are part of a formal R package, you would install and load the package. If they are in `.R` files, use the `source()` function.
4.  Run the examples provided in the code chunks above to see how the functions work.


## Function 1: `what_to_buy()`

This function allows you to download historical closing price data for specified WSE tickers within a given date range and visualize the trends.

### Usage

To use `what_to_buy()`, you need to provide a vector of ticker symbols and the start and end dates for the data download.

```{r what_to_buy_example, message=FALSE, warning=FALSE}
# Note: The getWSE script is sourced directly from GitHub in the function code.
# This example assumes you have internet access to download the data.

# Define tickers and date range
tickers <- c("PKN", "CDR", "PKO")
start_date <- "2023-01-01"
end_date <- "2023-12-31"

# Call the function
# Assuming the function definition is available in the R environment
# For this Rmd to work standalone, you might need to source the function definition first:
# source("your_package_file.R") # Replace with the actual path to your R file

# --- Include the function definition here for a self-contained Rmd example ---
# (In a real package, this would not be necessary as the function would be loaded)

# Run the function
what_to_buy_results <- what_to_buy(tickers, from = start_date, to = end_date)

# The function returns a list with the data frame and the plot
stock_data_df <- what_to_buy_results[[1]]
stock_plot <- what_to_buy_results[[2]]

# Display the first few rows of the data frame
print("Stock Data (first 5 rows):")
knitr::kable(head(stock_data_df))

# Display the plot
print("Stock Price Plot:")
stock_plot
```

### Disclaimer

This function relies on the external `getWSE()` script by m-dadej, available on GitHub. You can find the source script here: [getWSE.R on GitHub](https://github.com/m-dadej/Downloading-and-aggregating-stocks/blob/master/getWSE.R). The data includes corporate actions.


## Including Plots

You can also embed plots, for example:

## Function 2: `parts_distribution()`

This function calculates and visualizes the distribution of part variants within a manufacturing batch, considering a missing rate.

### Usage

Provide the number of part types, the total batch size, and the expected missing rate.

```{r parts_distribution_example, message=FALSE, warning=FALSE}
# --- Include the function definition here for a self-contained Rmd example ---
# (In a real package, this would not be necessary as the function would be loaded)

# Define parameters
num_parts <- 15
batch_size <- 800
missing_rate_val <- 1.1

# Call the function
parts_results <- parts_distribution(no_parts = num_parts, batch = batch_size, missing_rate = missing_rate_val)

# Display the resulting plot
print("Parts Distribution Plot:")
parts_results$plot

# Display the resulting data frame
print("Parts Distribution Data:")
knitr::kable(parts_results$data_frame)

# Display the sum in batch
print(paste("Total parts in technological distribution:", parts_results$sum_in_batch))
```


## Function 3: `analyze_parts_distribution()`

This function takes the output from `parts_distribution()` and performs further analysis, including descriptive statistics, normality checks, and fitting a normal distribution curve to the technological data plot.

### Usage

Pass the list output from `parts_distribution()` to this function.

```{r analyze_parts_distribution_example, message=FALSE, warning=FALSE}
# --- Include the function definition here for a self-contained Rmd example ---
# (In a real package, this would not be necessary as the function would be loaded)

# Assuming parts_results from the previous chunk is available
# If running this chunk independently, you would need to run parts_distribution first:
# num_parts <- 15
# batch_size <- 800
# missing_rate_val <- 1.1
# parts_results <- parts_distribution(no_parts = num_parts, batch = batch_size, missing_rate = missing_rate_val)


# Call the analysis function
analysis_results <- analyze_parts_distribution(parts_results)

# Display the summary statistics table
print("Summary Statistics:")
knitr::kable(analysis_results$summary_stats)

# Display the normality analysis table
print("Normality Analysis:")
knitr::kable(analysis_results$normality_analysis)

# Display the technological probabilities table
print("Technological Probabilities:")
knitr::kable(analysis_results$technological_probabilities)

# Display the modified plot with normal fit
print("Parts Distribution Plot with Normal Fit:")
analysis_results$plot_with_normal_fit
```

